{
  if (contentType != null) {
    contentType=contentType.toLowerCase().trim();
    if ("application/msexcel".equals(contentType) || "application/x-msexcel".equals(contentType) || "application/x-ms-excel".equals(contentType)|| "application/vnd.ms-excel".equals(contentType)|| "application/x-excel".equals(contentType)|| "application/xls".equals(contentType)) {
      return new ExcelImporter(false);
    }
 else     if ("application/x-xls".equals(contentType)) {
      return new ExcelImporter(true);
    }
 else     if ("application/xml".equals(contentType) || "text/xml".equals(contentType) || "application/rss+xml".equals(contentType)|| "application/atom+xml".equals(contentType)|| "application/rdf+xml".equals(contentType)) {
      return new XmlImporter();
    }
 else     if ("application/marc".equals(contentType)) {
      return new MarcImporter();
    }
  }
 else   if (fileName != null) {
    fileName=fileName.toLowerCase();
    if (fileName.endsWith(".xls")) {
      return new ExcelImporter(false);
    }
 else     if (fileName.endsWith(".xlsx")) {
      return new ExcelImporter(true);
    }
 else     if (fileName.endsWith(".xml") || fileName.endsWith(".rdf") || fileName.endsWith(".atom")|| fileName.endsWith(".rss")) {
      return new XmlImporter();
    }
 else     if (fileName.endsWith(".mrc") || fileName.endsWith(".marc") || fileName.contains(".mrc.")|| fileName.contains(".marc.")) {
      return new MarcImporter();
    }
  }
  return new TsvCsvImporter();
}
