{
  try {
    Project project=getProject(request);
    Engine engine=getEngine(request,project);
    response.setCharacterEncoding("UTF-8");
    response.setHeader("Content-Type","text/plain");
    PrintWriter writer=response.getWriter();
    boolean first=true;
    for (    Column column : project.columnModel.columns) {
      if (first) {
        first=false;
      }
 else {
        writer.print("\t");
      }
      writer.print(column.getHeaderLabel());
    }
    writer.print("\n");
{
      RowVisitor visitor=new RowVisitor(){
        PrintWriter writer;
        public RowVisitor init(        PrintWriter writer){
          this.writer=writer;
          return this;
        }
        @Override public boolean visit(        Project project,        int rowIndex,        Row row,        boolean contextual){
          boolean first=true;
          for (          Column column : project.columnModel.columns) {
            if (first) {
              first=false;
            }
 else {
              writer.print("\t");
            }
            int cellIndex=column.getCellIndex();
            if (cellIndex < row.cells.size()) {
              Cell cell=row.cells.get(cellIndex);
              if (cell != null && cell.value != null) {
                writer.print(cell.value);
              }
            }
          }
          writer.print("\n");
          return false;
        }
      }
.init(writer);
      FilteredRows filteredRows=engine.getAllFilteredRows(true);
      filteredRows.accept(project,visitor);
    }
  }
 catch (  Exception e) {
    respondException(response,e);
  }
}
