{
{
    RowVisitor visitor=new RowVisitor(){
      boolean columnHeader=true;
      public boolean visit(      Project project,      int rowIndex,      Row row){
        String[] vals=null;
        if (columnHeader) {
          String[] cols=new String[project.columnModel.columns.size()];
          for (int i=0; i < cols.length; i++) {
            cols[i]=project.columnModel.columns.get(i).getName();
          }
          columnHeader=false;
        }
        vals=new String[row.cells.size()];
        for (int i=0; i < vals.length; i++) {
          Cell cell=row.cells.get(i);
          if (cell != null) {
            vals[i]=row.cells.get(i).value.toString();
          }
        }
        return false;
      }
      @Override public void start(      Project project){
      }
      @Override public void end(      Project project){
      }
    }
;
    FilteredRows filteredRows=engine.getAllFilteredRows();
    filteredRows.accept(project,visitor);
  }
}
