{
  Map<Serializable,Set<Serializable>> cluster_map=new HashMap<Serializable,Set<Serializable>>();
  for (  Set<String> set : blocks.values()) {
    if (set.size() < 2)     continue;
    for (    String a : set) {
      for (      String b : set) {
        if (a == b)         continue;
        if (cluster_map.containsKey(a) && cluster_map.get(a).contains(b))         continue;
        if (cluster_map.containsKey(b) && cluster_map.get(b).contains(a))         continue;
        double d=_distance.d(a,b);
        if (d <= radius || radius < 0) {
          Set<Serializable> l=null;
          if (!cluster_map.containsKey(a)) {
            l=new TreeSet<Serializable>();
            l.add(a);
            cluster_map.put(a,l);
          }
 else {
            l=cluster_map.get(a);
          }
          l.add(b);
        }
      }
    }
  }
  List<Set<Serializable>> clusters=new ArrayList<Set<Serializable>>();
  for (  Entry<Serializable,Set<Serializable>> e : cluster_map.entrySet()) {
    Set<Serializable> v=e.getValue();
    if (v.size() > 1) {
      clusters.add(v);
    }
  }
  Collections.sort(clusters,new SizeComparator());
  return clusters;
}
