{
  URL url=new URL(GOOGLE_RPC_URL);
  JSONObject params=new JSONObject();
  params.put("query",query);
  params.put("key",API_KEY);
  JSONObject req1=new JSONObject();
  req1.put("jsonrpc","2.0");
  req1.put("id","q0");
  req1.put("method","freebase.mqlread");
  req1.put("apiVersion",FREEBASE_API_VERSION);
  req1.put("params",params);
  JSONArray body=new JSONArray();
  body.put(req1);
  HttpURLConnection connection=(HttpURLConnection)url.openConnection();
  connection.setRequestProperty("Content-Type","application/json");
  connection.setConnectTimeout(5000);
  connection.setDoOutput(true);
  OutputStreamWriter writer=new OutputStreamWriter(connection.getOutputStream(),"utf-8");
  try {
    writer.write(body.toString());
  }
  finally {
    writer.flush();
    writer.close();
  }
  connection.connect();
  JSONArray result=null;
  if (connection.getResponseCode() >= 400) {
    String responseMessage=connection.getResponseMessage();
    String errorStream=ParsingUtilities.inputStreamToString(connection.getErrorStream());
    LoggerFactory.getLogger("freebase").error("Error in mqlreadMime: " + connection.getResponseCode() + ":"+ responseMessage+ " : "+ errorStream);
  }
 else {
    InputStream is=connection.getInputStream();
    try {
      String s=ParsingUtilities.inputStreamToString(is);
      result=ParsingUtilities.evaluateJsonStringToArray(s);
    }
  finally {
      is.close();
    }
  }
  return result.getJSONObject(0);
}
