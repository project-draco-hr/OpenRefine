{
  List<Integer> rowIndices=new ArrayList<Integer>();
  List<DataExtension> dataExtensions=new ArrayList<DataExtension>();
  try {
    populateRowsWithMatches(rowIndices);
  }
 catch (  Exception e2) {
    e2.printStackTrace();
  }
  int start=0;
  while (start < rowIndices.size()) {
    int end=extendRows(rowIndices,dataExtensions,start,rowIndices.size());
    start=end;
    _progress=end * 100 / rowIndices.size();
    try {
      Thread.sleep(200);
    }
 catch (    InterruptedException e) {
      if (_canceled) {
        break;
      }
    }
  }
  if (!_canceled) {
    List<String> columnNames=new ArrayList<String>();
    for (    ColumnInfo info : _job.columns) {
      columnNames.add(StringUtils.join(info.names," - "));
    }
    List<FreebaseType> columnTypes=new ArrayList<FreebaseType>();
    for (    ColumnInfo info : _job.columns) {
      columnTypes.add(info.expectedType);
    }
    HistoryEntry historyEntry=new HistoryEntry(_project,_description,ExtendDataOperation.this,new DataExtensionChange(_baseColumnName,_columnInsertIndex,columnNames,columnTypes,rowIndices,dataExtensions));
    _project.history.addEntry(historyEntry);
    _project.processManager.onDoneProcess(this);
  }
}
