{
  response.setCharacterEncoding("UTF-8");
  response.setHeader("Content-Type","application/json");
  try {
    Project project=getProject(request);
    int rowIndex=Integer.parseInt(request.getParameter("row"));
    String starredString=request.getParameter("starred");
    if (starredString != null) {
      boolean starred="true".endsWith(starredString);
      String description=starred ? "Star row " + rowIndex : "Unstar row " + rowIndex;
      StarOneRowProcess process=new StarOneRowProcess(project,description,rowIndex,starred);
      boolean done=project.processManager.queueProcess(process);
      if (done) {
        JSONWriter writer=new JSONWriter(response.getWriter());
        writer.object();
        writer.key("code");
        writer.value("ok");
        writer.endObject();
      }
 else {
        respond(response,"{ \"code\" : \"pending\" }");
      }
    }
 else {
      respond(response,"{ \"code\" : \"error\", \"message\" : \"invalid command parameters\" }");
    }
  }
 catch (  Exception e) {
    respondException(response,e);
  }
}
