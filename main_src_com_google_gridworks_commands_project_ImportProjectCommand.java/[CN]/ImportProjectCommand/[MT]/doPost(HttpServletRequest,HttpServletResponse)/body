{
  ProjectManager.singleton.setBusy(true);
  try {
    Properties options=ParsingUtilities.parseUrlParameters(request);
    long projectID=Project.generateID();
    logger.info("Importing existing project using new ID {}",projectID);
    internalImport(request,options,projectID);
    ProjectManager.singleton.loadProjectMetadata(projectID);
    ProjectMetadata pm=ProjectManager.singleton.getProjectMetadata(projectID);
    if (pm != null) {
      if (options.containsKey("project-name")) {
        String projectName=options.getProperty("project-name");
        if (projectName != null && projectName.length() > 0) {
          pm.setName(projectName);
        }
      }
      redirect(response,"/project?project=" + projectID);
    }
 else {
      redirect(response,"/error.html?redirect=index&msg=" + ParsingUtilities.encode("Failed to import project"));
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
 finally {
    ProjectManager.singleton.setBusy(false);
  }
}
