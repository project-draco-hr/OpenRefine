{
  int lastVisitedRowRowIndex=-1;
  int lastRecordRowAcceptedRowIndex=-1;
  int c=project.rows.size();
  for (int rowIndex=0; rowIndex < c; rowIndex++) {
    Row row=project.rows.get(rowIndex);
    if (matchRow(project,rowIndex,row)) {
      if (row.recordIndex >= 0) {
        lastRecordRowAcceptedRowIndex=rowIndex;
      }
      visitRow(project,visitor,rowIndex,row,lastVisitedRowRowIndex);
      lastVisitedRowRowIndex=rowIndex;
    }
 else     if (_includeDependent && row.recordIndex < 0 && row.contextRows != null && row.contextRows.size() > 0 && row.contextRows.get(0) == lastRecordRowAcceptedRowIndex) {
      visitor.visit(project,rowIndex,row,false,true);
      lastVisitedRowRowIndex=rowIndex;
    }
  }
}
