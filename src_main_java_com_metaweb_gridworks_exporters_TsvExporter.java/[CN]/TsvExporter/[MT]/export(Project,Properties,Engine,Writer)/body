{
  boolean first=true;
  for (  Column column : project.columnModel.columns) {
    if (first) {
      first=false;
    }
 else {
      writer.write("\t");
    }
    writer.write(column.getName());
  }
  writer.write("\n");
{
    RowVisitor visitor=new RowVisitor(){
      Writer writer;
      public RowVisitor init(      Writer writer){
        this.writer=writer;
        return this;
      }
      public boolean visit(      Project project,      int rowIndex,      Row row,      boolean contextual,      boolean includeDependent){
        boolean first=true;
        try {
          for (          Column column : project.columnModel.columns) {
            if (first) {
              first=false;
            }
 else {
              writer.write("\t");
            }
            int cellIndex=column.getCellIndex();
            if (cellIndex < row.cells.size()) {
              Cell cell=row.cells.get(cellIndex);
              if (cell != null && cell.value != null) {
                Object v=cell.value;
                String s=v instanceof String ? ((String)v) : v.toString();
                s=s.replace("\\","\\\\").replace("\n","\\n").replace("\r","\\r").replace("\t","\\t");
                writer.write(s);
              }
            }
          }
          writer.write("\n");
        }
 catch (        IOException e) {
        }
        return false;
      }
    }
.init(writer);
    FilteredRows filteredRows=engine.getAllFilteredRows(true);
    filteredRows.accept(project,visitor);
  }
}
