{
  Column column=project.columnModel.columns.get(_cellIndex);
  if (column == null) {
    throw new Exception("No column corresponding to cell index " + _cellIndex);
  }
  List<Row> newRows=new ArrayList<Row>();
  int oldRowCount=project.rows.size();
  for (int r=0; r < oldRowCount; r++) {
    Row oldRow=project.rows.get(r);
    if (oldRow.isCellBlank(_cellIndex)) {
      newRows.add(oldRow.dup());
      continue;
    }
    Object value=oldRow.getCellValue(_cellIndex);
    String s=value instanceof String ? ((String)value) : value.toString();
    String[] values=null;
    if (_mode.equals("regex")) {
      values=s.split(_separator);
    }
 else {
      values=StringUtils.splitByWholeSeparator(s,_separator);
    }
    if (values.length < 2) {
      newRows.add(oldRow.dup());
      continue;
    }
{
      Row firstNewRow=oldRow.dup();
      firstNewRow.setCell(_cellIndex,new Cell(values[0].trim(),null));
      newRows.add(firstNewRow);
    }
    int r2=r + 1;
    for (int v=1; v < values.length; v++) {
      Cell newCell=new Cell(values[v].trim(),null);
      if (r2 < project.rows.size()) {
        Row oldRow2=project.rows.get(r2);
        if (oldRow2.isCellBlank(_cellIndex) && oldRow2.isCellBlank(_keyCellIndex)) {
          Row newRow=oldRow2.dup();
          newRow.setCell(_cellIndex,newCell);
          newRows.add(newRow);
          r2++;
          continue;
        }
      }
      Row newRow=new Row(_cellIndex + 1);
      newRow.setCell(_cellIndex,newCell);
      newRows.add(newRow);
    }
    r=r2 - 1;
  }
  String description="Split multi-value cells in column " + column.getHeaderLabel();
  Change change=new MassRowChange(newRows);
  HistoryEntry historyEntry=new HistoryEntry(project,description,this,change);
  return new QuickHistoryEntryProcess(project,historyEntry);
}
