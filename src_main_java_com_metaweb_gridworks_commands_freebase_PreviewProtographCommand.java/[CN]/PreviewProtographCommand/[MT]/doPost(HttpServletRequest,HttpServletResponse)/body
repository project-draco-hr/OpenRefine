{
  try {
    Project project=getProject(request);
    Engine engine=getEngine(request,project);
    FilteredRows filteredRows=engine.getAllFilteredRows();
    response.setCharacterEncoding("UTF-8");
    response.setHeader("Content-Type","application/json");
    String jsonString=request.getParameter("protograph");
    JSONObject json=ParsingUtilities.evaluateJsonStringToObject(jsonString);
    Protograph protograph=Protograph.reconstruct(json);
    StringBuffer sb=new StringBuffer(2048);
    sb.append("{ ");
{
      StringWriter stringWriter=new StringWriter();
      TripleLoaderTransposedNodeFactory nodeFactory=new TripleLoaderTransposedNodeFactory(stringWriter);
      Transposer.transpose(project,filteredRows,protograph,protograph.getRootNode(0),nodeFactory);
      nodeFactory.flush();
      sb.append("\"tripleloader\" : ");
      sb.append(JSONObject.quote(stringWriter.toString()));
    }
{
      MqlreadLikeTransposedNodeFactory nodeFactory=new MqlreadLikeTransposedNodeFactory();
      Transposer.transpose(project,filteredRows,protograph,protograph.getRootNode(0),nodeFactory);
      JSONArray results=nodeFactory.getJSON();
      sb.append(", \"mqllike\" : ");
      sb.append(results.toString());
    }
    sb.append(" }");
    respond(response,sb.toString());
  }
 catch (  Exception e) {
    respondException(response,e);
  }
}
