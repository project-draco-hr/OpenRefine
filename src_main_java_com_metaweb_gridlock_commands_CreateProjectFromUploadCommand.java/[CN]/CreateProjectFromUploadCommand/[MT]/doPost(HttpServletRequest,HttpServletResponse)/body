{
  Properties properties=new Properties();
  String content=readFileUpload(request,properties);
  ProjectMetadata pm=new ProjectMetadata();
  pm.name=properties.getProperty("project-name");
  pm.password=properties.getProperty("project-password");
  Project project=ProjectManager.singleton.createProject(pm);
  int start=0;
  String sep=null;
  String line=null;
  boolean first=true;
  int cellCount=1;
  while (start < content.length()) {
    int newline=content.indexOf('\n',start);
    if (newline < 0) {
      line=content.substring(start);
      start=content.length();
    }
 else {
      line=content.substring(start,newline);
      start=newline + 1;
    }
    if (sep == null) {
      int tab=line.indexOf('\t');
      if (tab >= 0) {
        sep="\t";
      }
 else {
        sep=",";
      }
    }
    if (first) {
      String[] cells=line.split(sep);
      first=false;
      for (int c=0; c < cells.length; c++) {
        String cell=cells[c];
        if (cell.startsWith("\"") && cell.endsWith("\"")) {
          cell=cell.substring(1,cell.length() - 1);
        }
        Column column=new Column();
        column.cellIndex=c;
        column.headerLabel=cell;
        project.columnModel.columns.add(column);
      }
      cellCount=cells.length;
    }
 else {
      Row row=new Row(cellCount);
      if (sep.charAt(0) == ',') {
        parseCSVIntoRow(row,line);
      }
 else {
        parseTSVIntoRow(row,line);
      }
      project.rows.add(row);
    }
  }
  redirect(response,"/project.html?project=" + project.id);
}
