{
  String baseUrl=options.getProperty("base-url");
  Graph graph=JrdfFactory.getNewGraph();
  LineHandler lineHandler=nTriplesParserFactory.createParser(graph,newMapFactory);
  GraphLineParser parser=new GraphLineParser(graph,lineHandler);
  parser.parse(reader,baseUrl);
  project.columnModel.columns.add(0,new Column(0,"subject"));
  project.columnModel.update();
  ClosableIterable<Triple> triples=graph.find(ANY_SUBJECT_NODE,ANY_PREDICATE_NODE,ANY_OBJECT_NODE);
  try {
    for (    Triple triple : triples) {
      String subject=triple.getSubject().toString();
      String predicate=triple.getPredicate().toString();
      String object=triple.getObject().toString();
      int candidateMergeRowIndex=-1;
      int columnIndex=project.columnModel.getColumnIndexByName(predicate);
      if (columnIndex == -1) {
        candidateMergeRowIndex=AddNewColumn(project,predicate,subject);
      }
      columnIndex=project.columnModel.getColumnIndexByName(predicate);
      if (candidateMergeRowIndex > -1) {
        if (project.rows.get(candidateMergeRowIndex).cells.get(columnIndex) == null) {
          MergeWithRow(project,candidateMergeRowIndex,columnIndex,object);
        }
 else {
          AddNewRow(project,subject,predicate,object);
        }
      }
 else {
        AddNewRow(project,subject,predicate,object);
      }
    }
  }
  finally {
    triples.iterator().close();
  }
}
