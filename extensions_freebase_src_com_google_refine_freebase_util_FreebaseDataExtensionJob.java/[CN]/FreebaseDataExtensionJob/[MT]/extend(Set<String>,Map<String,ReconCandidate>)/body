{
  StringWriter writer=new StringWriter();
  formulateQuery(ids,extension,writer);
  String query=writer.toString();
  String result=FreebaseUtils.mqlread(query);
  JSONObject o=ParsingUtilities.evaluateJsonStringToObject(result);
  Map<String,FreebaseDataExtensionJob.DataExtension> map=new HashMap<String,FreebaseDataExtensionJob.DataExtension>();
  if (o.has("result")) {
    JSONArray a=o.getJSONArray("result");
    int l=a.length();
    for (int i=0; i < l; i++) {
      JSONObject o2=a.getJSONObject(i);
      String id=o2.getString("id");
      FreebaseDataExtensionJob.DataExtension ext=collectResult(o2,reconCandidateMap);
      if (ext != null) {
        map.put(id,ext);
      }
    }
  }
  return map;
}
