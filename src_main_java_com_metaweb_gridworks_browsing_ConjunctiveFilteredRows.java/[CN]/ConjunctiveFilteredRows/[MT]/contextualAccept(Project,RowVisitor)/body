{
  int lastVisitedRow=-1;
  for (int i=0; i < project.rows.size(); i++) {
    Row row=project.rows.get(i);
    boolean ok=true;
    for (    RowFilter rowFilter : _rowFilters) {
      if (!rowFilter.filterRow(project,i,row)) {
        ok=false;
        break;
      }
    }
    if (ok) {
      if (row.contextRows != null && lastVisitedRow < i - 1) {
        for (        int contextRowIndex : row.contextRows) {
          if (contextRowIndex > lastVisitedRow) {
            visitor.visit(project,contextRowIndex,project.rows.get(contextRowIndex),true);
            lastVisitedRow=contextRowIndex;
          }
        }
      }
      visitor.visit(project,i,row,false);
      lastVisitedRow=i;
    }
  }
}
