{
  String baseName=column.getName();
  if (_nameToColumn.containsKey(baseName)) {
    if (!avoidNameCollision) {
      throw new ModelException("Duplicated column name");
    }
  }
  String name=baseName;
  int i=1;
  while (true) {
    if (_nameToColumn.containsKey(name)) {
      i++;
      name=baseName + i;
    }
 else {
      break;
    }
  }
  column.setName(name);
  columns.add(index < 0 ? columns.size() : index,column);
  _nameToColumn.put(name,column);
}
