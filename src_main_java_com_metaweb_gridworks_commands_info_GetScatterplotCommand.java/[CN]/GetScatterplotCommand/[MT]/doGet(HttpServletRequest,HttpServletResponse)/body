{
  try {
    Project project=getProject(request);
    Engine engine=getEngine(request,project);
    JSONObject conf=getJsonParameter(request,"plotter");
    response.setHeader("Content-Type",charter.getContentType());
    ServletOutputStream sos=null;
    try {
      sos=response.getOutputStream();
      charter.draw(sos,project,engine,conf);
    }
  finally {
      sos.close();
    }
  }
 catch (  Exception e) {
    respondException(response,e);
  }
}
