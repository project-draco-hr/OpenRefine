{
  int ignoreLines=ImporterUtilities.getIntegerOption("ignore",options,-1);
  int headerLines=ImporterUtilities.getIntegerOption("header-lines",options,1);
  int limit=ImporterUtilities.getIntegerOption("limit",options,-1);
  int skip=ImporterUtilities.getIntegerOption("skip",options,0);
  int dataStart=ignoreLines + headerLines + skip;
  boolean guessValueType=ImporterUtilities.getBooleanOption("guess-value-type",options,true);
  metadata.setCustomMetadata("source-url",url.toExternalForm());
  if (isSpreadsheetURL(url)) {
    importSpreadsheet(url,project,ignoreLines,headerLines,limit,dataStart,guessValueType);
  }
 else   if (isFusionTableURL(url)) {
    importFusionTable(url,project,ignoreLines,headerLines,limit,dataStart,guessValueType);
  }
 else {
    throw new IllegalArgumentException("Got invalid format URL in GDataImporter.read()");
  }
}
