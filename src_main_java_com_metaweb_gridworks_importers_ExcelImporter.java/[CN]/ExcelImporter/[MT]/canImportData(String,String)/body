{
  if (contentType != null) {
    contentType=contentType.toLowerCase().trim();
    if ("application/msexcel".equals(contentType) || "application/x-msexcel".equals(contentType) || "application/x-ms-excel".equals(contentType)|| "application/vnd.ms-excel".equals(contentType)|| "application/x-excel".equals(contentType)|| "application/xls".equals(contentType)) {
      this._xmlBased=false;
      return true;
    }
 else     if ("application/x-xls".equals(contentType)) {
      this._xmlBased=true;
      return true;
    }
  }
 else   if (fileName != null) {
    fileName=fileName.toLowerCase();
    if (fileName.endsWith(".xls")) {
      this._xmlBased=false;
      return true;
    }
 else     if (fileName.endsWith(".xlsx")) {
      this._xmlBased=true;
      return true;
    }
  }
  return false;
}
